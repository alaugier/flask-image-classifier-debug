<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Upload image</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 2rem; }
      .card { border: 1px solid #ddd; padding: 1.5rem; border-radius: 10px; max-width: 520px; }
      button { padding: .6rem 1rem; border-radius: 8px; border: 1px solid #222; background: #fff; cursor: pointer; }
      input[type=file]{ margin: 1rem 0; }
      .hint { color:#666; font-size: .9rem; }
      #preview { display:none; max-width: 420px; border-radius: 10px; margin: 1rem 0; }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Classification images satellite</h1>
      
      <form action="/predict" method="post" enctype="multipart/form-data">
        <input id="fileInput" type="file" name="file" accept="image/*" required />
        <img id="preview" alt="aperçu de l’image sélectionnée" />
        <div><button type="submit">Valider</button></div>
      </form>
    </div>

    <script>
      (function () {
        const input = document.getElementById('fileInput');
        const preview = document.getElementById('preview');
        let currentURL = null;

        input.addEventListener('change', () => {
          const file = input.files && input.files[0];
          if (!file || !file.type.startsWith('image/')) {
            preview.style.display = 'none';
            if (currentURL) { URL.revokeObjectURL(currentURL); currentURL = null; }
            return;
          }
          if (currentURL) URL.revokeObjectURL(currentURL);
          currentURL = URL.createObjectURL(file);
          preview.src = currentURL;
          preview.onload = () => { URL.revokeObjectURL(currentURL); currentURL = null; };
          preview.style.display = 'block';
        });
      })();
    </script>
  </body>
</html>
